@using Models.Characters
@using Persistence.Json;
@using UI.Services
@using static UI.Constants;
@inject IStorageService Storage
@inject ICharacterCoordinator Coordinator
@inject NavigationManager Navigator

<MudCard Outlined="true" Class="mx-4 my-1">
	<MudCardHeader >
		<MudText Typo="Typo.h4">@Playbook</MudText>
	</MudCardHeader>
	<MudCardContent>
		<MudText Typo="Typo.body1" Class="my-2">@Hook[..(Hook.IndexOf(".")+1)]</MudText>
		<MudText Typo="Typo.body1" Class="my-2">@Hook[(Hook.IndexOf(".")+1)..]</MudText>
	</MudCardContent>
	<MudCardActions>
		<MudButton Color="Color.Primary" FullWidth="true" OnClick="CreateCharacter">Create @Playbook</MudButton>
	</MudCardActions>
</MudCard>

@code
{
	[Parameter]
	public PlaybookOption Playbook { get; set; }

	[Parameter]
	public string Hook { get; set; } = string.Empty;

	public async Task CreateCharacter()
	{
		var character = await Coordinator.InitializeCharacter(Playbook);
		await Storage.Save(character);
		Navigator.NavigateTo(Paths.Character(character.Id));
	}
}
